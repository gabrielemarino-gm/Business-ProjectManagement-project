<document>

<filing_date>
2019-10-31
</filing_date>

<publication_date>
2020-09-03
</publication_date>

<priority_date>
2019-02-26
</priority_date>

<ipc_classes>
G06K9/00
</ipc_classes>

<assignee>
BEIJING SENSETIME TECHNOLOGY DEVELOPMENT COMPANY
</assignee>

<inventors>
QIAN, CHEN
WANG FEI
</inventors>

<docdb_family_id>
66929610
</docdb_family_id>

<title>
FACE RECOGNITION METHOD, NEURAL NETWORK TRAINING METHOD, APPARATUS, AND ELECTRONIC DEVICE
</title>

<abstract>
A face recognition method, a neural network training method, an apparatus, and an electronic device. The method comprises: obtaining a first face image by means of a first camera (101); extracting a first face feature of the first face image (102); comparing the first face feature with a pre-stored second face feature to obtain a reference similarity, the second face feature being obtained by extracting a feature of a second face image obtained by a second camera, and the second camera and the first camera being different types of cameras (103); and determining, according to the reference similarity, whether the first face feature and the second face feature correspond to a same person (104).
</abstract>

<claims>
权利要求
1、 一种人脸识别方法,其特征在于,包括:
通过第一摄像头获取第一人脸图像;
提取所述第一人脸图像的第一人脸特征;
将所述第一人脸特征与预先存储的第二人脸特征进行对比,获得参考相似度,所述第 二人脸特征经第二摄像头获取的第二人脸图像的特征提取而得,所述第二摄像头与所述第 一摄像头属于不同类型的摄像头;
根据所述参考相似度确定所述第一人脸特征与所述第二人脸特征是否对应相同人。
2、 根据权利要求 1所述的方法,其特征在于,
所述第一摄像头为热成像摄像头,所述第二摄像头为可见光摄像头;
或者,所述第一摄像头为可见光摄像头,所述第一摄像头为热成像摄像头。
3、 根据权利要求 1或 2所述的方法,其特征在于,所述根据所述参考相似度确定所 述第一人脸特征与所述第二人脸特征是否对应相同人,包括:
根据所述参考相似度、 参考误报率以及相似度阈值确定所述第一人脸特征与所述第二 人脸特征是否对应相同人;其中,不同的误报率对应不同的相似度阈值。
4、 根据权利要求 1或 2所述的方法,其特征在于,所述根据所述参考相似度确定所 述第一人脸特征与所述第二人脸特征是否对应相同人,包括:
根据所述参考相似度以及阈值信息确定归一化后的参考相似度;
根据所述归一化后的参考相似度确定所述第一人脸特征与所述第二人脸特征是否对 应相同人。
5、 根据权利要求 1-4任一项所述的方法,其特征在于,所述提取所述第一人脸图像的 第_人脸特征,包括:
将所述第一人脸图像输入预先训练完成的神经网络,通过所述神经网络输出所述第一 人脸图像的第一人脸特征;其中,所述神经网络基于第一类型图像样本和第二类型图像样 本训练得到,所述第一类型图像样本和所述第二类型图像样本由不同类型的摄像头拍摄得 到,且所述第一类型图像样本和所述第二类型图像样本中包括人脸。
6、 根据权利要求 5 所述的方法,其特征在于,所述神经网络基于所述第一类型图像 样本、 所述第二类型图像样本和混合类型图像样本训练得到,所述混合类型图像样本由所 述第一类型图像样本和所述第二类型图像样本配对而得。
1、 根据权利要求 1-6任一项所述的方法,其特征在于,所述第一摄像头包括车载摄像 头,所述通过第一摄像头获取第一人脸图像,包括:
通过所述车载摄像头获取所述第一人脸图像,所述第一人脸图像包括车辆的用车人的 人脸图像。
8、 根据权利要求 7 所述的方法,其特征在于,所述用车人包括驾驶所述车辆的人、 乘坐所述车辆的人、 对所述车辆进行修理的人、 给所述车辆加油的人以及控制所述车辆的 人中的一项或多项。
9、 根据权利要求 7 所述的方法,其特征在于,所述用车人包括驾驶所述车辆的人, 所述通过所述车载摄像头获取所述第一人脸图像,包括: 在接收到触发指令的情况下,通过所述车载摄像头获取所述第一人脸图像; 或者,在所述车辆运行时,通过所述车载摄像头获取所述第一人脸图像;
或者,在所述车辆的运行速度达到参考速度的情况下,通过所述车载摄像头获取所述 第一人脸图像。
10、 根据权利要求 7-9任一项所述的方法,其特征在于,所述第二人脸图像为对所述 用车人进行人脸注册的图像,所述将所述第一人脸特征与预先存储的第二人脸特征进行对 比之前,所述方法还包括:
通过所述第二摄像头获取所述第二人脸图像;
提取所述第二人脸图像的第二人脸特征;
保存所述第二人脸图像的第二人脸特征。
11、 一种神经网络训练方法,其特征在于,包括:
获取第一类型图像样本和第二类型图像样本,所述第一类型图像样本和所述第二类型 图像样本由不同类型的摄像头拍摄得到,且所述第一类型图像样本和所述第二类型图像样 本中包括人脸;
根据所述第一类型图像样本和所述第二类型图像样本训练神经网络。
12、 根据权利要求 11所述的方法,其特征在于,所述根据所述第一类型图像样本和所 述第二类型图像样本训练神经网络,包括:
将所述第一类型图像样本和所述第二类型图像样本配对,得到所述第一类型图像样本 和所述第二类型图像样本的混合类型图像样本;
根据所述第一类型图像样本、 所述第二类型图像样本和所述混合类型图像样本,训练 所述神经网络。
13、 根据权利要求 12 所述的方法,其特征在于,所述根据所述第一类型图像样本、 所述第二类型图像样本和所述混合类型图像样本,训练所述神经网络,包括:
通过所述神经网络获取所述第一类型图像样本的人脸预测结果、 所述第二类型图像样 本的人脸预测结果和所述混合类型图像样本的人脸预测结果;
根据所述第一类型图像样本的人脸预测结果和人脸标注结果的差异、 所述第二类型图 像样本的人脸预测结果和人脸标注结果之间的差异、 以及所述混合类型图像样本的人脸预 测结果和人脸标注结果的差异,训练所述神经网络。
14、 根据权利要求 13 所述的方法,其特征在于,所述神经网络中包括第一分类器、 第二分类器和混合分类器,所述通过所述神经网络获取所述第一类型图像样本的人脸预测 结果、 所述第二类型图像样本的人脸预测结果和所述混合类型图像样本的人脸预测结果, 包括:
将所述第一类型图像样本的人脸特征输入至所述第一分类器中,得到所述第一类型图 像样本的人脸预测结果;
将所述第二类型图像样本的人脸特征输入至所述第二分类器中,得到所述第二类型图 像样本的人脸预测结果;
将所述混合类型图像样本的人脸特征输入至所述混合分类器中,得到所述混合类型图 像样本的人脸预测结果。 15、 根据权利要求 14所述的方法,其特征在于,所述方法还包括:
在训练完成的所述神经网络中去除所述第一分类器、 所述第二分类器和所述混合分类 器,得到用于进行人脸识别的神经网络。
16、 一种人脸识别装置,其特征在于,包括:
第一获取单元,用于通过第一摄像头获取第一人脸图像;
第一提取单元,用于提取所述第一人脸图像的第一人脸特征;
对比单元,用于将所述第一人脸特征与预先存储的第二人脸特征进行对比,获得参考 相似度,所述第二人脸特征经第二摄像头获取的第二人脸图像的特征提取而得,所述第二 摄像头与所述第一摄像头属于不同类型的摄像头;
确定单元,用于根据所述参考相似度确定所述第一人脸特征与所述第二人脸特征是否 对应相同人。
17、 根据权利要求 16所述的装置,其特征在于,
所述第一摄像头为热成像摄像头,所述第二摄像头为可见光摄像头;
或者,所述第一摄像头为可见光摄像头,所述第一摄像头为热成像摄像头。
18、 根据权利要求 16或 17所述的装置,其特征在于,
所述确定单元,具体用于根据所述参考相似度、 参考误报率以及相似度阈值确定所述 第一人脸特征与所述第二人脸特征是否对应相同人;其中,不同的误报率对应不同的相似 度阈值。
19、 根据权利要求 16或 17所述的装置,其特征在于,
所述确定单元,具体用于根据所述参考相似度以及阈值信息确定归一化后的参考相似 度;以及根据所述归一化后的参考相似度确定所述第一人脸特征与所述第二人脸特征是否 对应相同人。
20、 根据权利要求 16-19任_项所述的装置,其特征在于,
所述第一提取单元,具体用于将所述第一人脸图像输入预先训练完成的神经网络,通 过所述神经网络输出所述第一人脸图像的第一人脸特征;其中,所述神经网络基于第一类 型图像样本和第二类型图像样本训练得到,所述第一类型图像样本和所述第二类型图像样 本由不同类型的摄像头拍摄得到,且所述第一类型图像样本和所述第二类型图像样本中包 括人脸。
21、 根据权利要求 20 所述的装置,其特征在于,所述神经网络基于所述第一类型图 像样本、 所述第二类型图像样本和混合类型图像样本训练得到,所述混合类型图像样本由 所述第一类型图像样本和所述第二类型图像样本配对而得。
22、 根据权利要求 16-21任一项所述的装置,其特征在于,所述第一摄像头包括车载 摄像头,
所述第一获取单元,具体用于通过所述车载摄像头获取所述第一人脸图像,所述第一 人脸图像包括车辆的用车人的人脸图像。
23、 根据权利要求 22所述的装置,其特征在于,所述用车人包括驾驶所述车辆的人、 乘坐所述车辆的人、 对所述车辆进行修理的人、 给所述车辆加油的人以及控制所述车辆的 人中的一项或多项。 24、 根据权利要求 22所述的装置,其特征在于,所述用车人包括驾驶所述车辆的人, 所述第一获取单元,具体用于在接收到触发指令的情况下,通过所述车载摄像头获取所述 第一人脸图像;
或者,所述第一获取单元,具体用于在所述车辆运行时,通过所述车载摄像头获取所 述第 _人脸图像;
或者,所述第一获取单元,具体用于在所述车辆的运行速度达到参考速度的情况下, 通过所述车载摄像头获取所述第一人脸图像。
25、 根据权利要求 22-24任一项所述的装置,其特征在于,所述第二人脸图像为对所 述用车人进行人脸注册的图像,所述装置还包括:
第二获取单元,用于通过所述第二摄像头获取所述第二人脸图像;
第二提取单元,用于提取所述第二人脸图像的第二人脸特征;
保存单元,用于保存所述第二人脸图像的第二人脸特征。
26、 一种神经网络训练装置,其特征在于,包括:
获取单元,用于获取第一类型图像样本和第二类型图像样本,所述第一类型图像样本 和所述第二类型图像样本由不同类型的摄像头拍摄得到,且所述第一类型图像样本和所述 第二类型图像样本中包括人脸;
训练单元,用于根据所述第一类型图像样本和所述第二类型图像样本训练神经网络。
27、 根据权利要求 26所述的装置,其特征在于,所述训练单元包括:
配对子单元,用于将所述第一类型图像样本和所述第二类型图像样本配对,得到所述 第一类型图像样本和所述第二类型图像样本的混合类型图像样本;
训练子单元,用于根据所述第一类型图像样本、 所述第二类型图像样本和所述混合类 型图像样本,训练所述神经网络。
28、 根据权利要求 27所述的装置,其特征在于,
所述训练子单元,具体用于通过所述神经网络获取所述第一类型图像样本的人脸预测 结果、 所述第二类型图像样本的人脸预测结果和所述混合类型图像样本的人脸预测结果; 以及根据所述第一类型图像样本的人脸预测结果和人脸标注结果的差异、 所述第二类型图 像样本的人脸预测结果和人脸标注结果之间的差异、 以及所述混合类型图像样本的人脸预 测结果和人脸标注结果的差异,训练所述神经网络。
29、 根据权利要求 28 所述的装置,其特征在于,所述神经网络中包括第一分类器、 第二分类器和混合分类器,
所述训练子单元,具体用于将所述第一类型图像样本的人脸特征输入至所述第一分类 器中,得到所述第一类型图像样本的人脸预测结果;以及将所述第二类型图像样本的人脸 特征输入至所述第二分类器中,得到所述第二类型图像样本的人脸预测结果;以及将所述 混合类型图像样本的人脸特征输入至所述混合分类器中,得到所述混合类型图像样本的人 脸预测结果。
30、 根据权利要求 29所述的装置,其特征在于,所述装置还包括:
神经网络应用单元,用于在训练完成的所述神经网络中去除所述第一分类器、 所述第 二分类器和所述混合分类器,得到用于进行人脸识别的神经网络。 31、 一种电子设备,其特征在于,包括处理器和存储器,所述处理器和所述存储器耦 合;其中,所述存储器用于存储程序指令,所述程序指令被所述处理器执行时,使所述处 理器执行权利要求 1-10任一项所述的方法;和/或,使所述处理器执行权利要求 11-15任一 项所述的方法。
32、 一种计算机可读存储介质,其特征在于,所述计算机可读存储介质中存储有计算 机程序,所述计算机程序包括程序指令,所述程序指令当被处理器执行时,使所述处理器 执行权利要求 1-10任一项所述的方法;和/或,使所述处理器执行权利要求 11-15任一项所 述的方法。
</claims>
</document>
