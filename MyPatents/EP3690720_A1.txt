<document>

<filing_date>
2020-01-21
</filing_date>

<publication_date>
2020-08-05
</publication_date>

<priority_date>
2019-01-30
</priority_date>

<ipc_classes>
G06K9/00
</ipc_classes>

<assignee>
STRADVISION
</assignee>

<inventors>
BOO, SUKHOON
CHO, HOJIN
JANG, TAEWOONG
JE, HONGMO
JEONG, KYUNGJOONG
KIM, HAK-KYOUNG
KIM, KYE-HYEON
KIM, YONGJOONG
LEE, HYUNGSOO
LEE, MYEONG-CHUN
NAM, WOONHYUN
RYU, WOOJU
SHIN, DONGSOO
SUNG, MYUNGCHUL
YEO, DONGHUN
</inventors>

<docdb_family_id>
70461267
</docdb_family_id>

<title>
METHOD AND DEVICE FOR ESTIMATING HEIGHT AND WEIGHT OF PASSENGERS USING BODY PART LENGTH AND FACE INFORMATION BASED ON HUMAN'S STATUS RECOGNITION
</title>

<abstract>
A method for detecting body information on passengers of a vehicle based on humans' status recognition is provided. The method includes steps of: a passenger body information-detecting device, (a) inputting an interior image of the vehicle into a face recognition network, to detect faces of the passengers and output passenger feature information, and inputting the interior image into a body recognition network, to detect bodies and output body-part length information; and (b) retrieving specific height mapping information by referring to a height mapping table of ratios of segment body portions of human groups to heights per the human groups, acquiring a specific height of the specific passenger, retrieving specific weight mapping information from a weight mapping table of correlations between the heights and weights per the human groups, and acquiring a weight of the specific passenger by referring to the specific height.
</abstract>

<claims>
1. A method for detecting body information on one or more passengers of a vehicle based on humans' status recognition, comprising steps of: (a) if at least one interior image of an interior of the vehicle is acquired, a passenger body information-detecting device performing (i) a process of inputting the interior image into a face recognition network, to thereby allow the face recognition network to detect each of faces of each of the passengers from the interior image, and thus to output multiple pieces of passenger feature information corresponding to each of the detected faces, and (ii) a process of inputting the interior image into a body recognition network, to thereby allow the body recognition network to detect each of bodies of each of the passengers from the interior image, and thus to output body-part length information of each of the detected bodies; and (b) the passenger body information-detecting device performing a process of retrieving specific height mapping information corresponding to specific passenger feature information on a specific passenger from a height mapping table which stores height mapping information representing respective one or more predetermined ratios of one or more segment body portions of each of human groups to each of heights per each of the human groups, a process of acquiring a specific height of the specific passenger from the specific height mapping information by referring to specific body-part length information of the specific passenger, a process of retrieving specific weight mapping information corresponding to the specific passenger feature information from a weight mapping table which stores multiple pieces of weight mapping information representing predetermined correlations between each of the heights and each of weights per each of the human groups, and a process of acquiring a weight of the specific passenger from the specific weight mapping information by referring to the specific height of the specific passenger.
2. The method of Claim 1, wherein, at the step of (a), the passenger body information-detecting device performs a process of inputting the interior image into the body recognition network, to thereby allow the body recognition network to (i) output one or more feature tensors with one or more channels corresponding to the interior image via a feature extraction network, (ii) generate at least one keypoint heatmap and at least one part affinity field with one or more channels corresponding to each of the feature tensors via a keypoint heatmap & part affinity field extractor, and (iii) extract keypoints from the keypoint heatmap via a keypoint detector, to group the extracted keypoints by referring to the part affinity field, and thus to generate body parts per the passengers, and as a result, allow the body recognition network to output multiple pieces of body-part length information on each of the passengers by referring to the body parts per the passengers.
3. The method of Claim 2, wherein the feature extraction network includes at least one convolutional layer and applies at least one convolution operation to the interior image, to thereby output the feature tensors.
4. The method of Claim 2, wherein the keypoint heatmap & part affinity field extractor includes one of a fully convolutional network and a 1×1 convolutional layer, and applies a fully-convolution operation or 1×1 convolution operation to the feature tensors, to thereby generate the keypoint heatmap and the part affinity field.
5. The method of Claim 2, wherein the keypoint detector connects, by referring to the part affinity field, pairs respectively having highest mutual connection probabilities of being connected among the extracted keypoints, to thereby group the extracted keypoints.
6. The method of Claim 2, wherein the feature extraction network and the keypoint heatmap & part affinity field extractor have been learned by a learning device performing (i) a process of inputting at least one training image including one or more objects for training into the feature extraction network, to thereby allow the feature extraction network to generate one or more feature tensors for training having one or more channels by applying at least one convolutional operation to the training image, (ii) a process of inputting the feature tensors for training into the keypoint heatmap & part affinity field extractor, to thereby allow the keypoint heatmap & part affinity field extractor to generate one or more keypoint heatmaps for training and one or more part affinity fields for training having one or more channels for each of the feature tensors for training, (iii) a process of inputting the keypoint heatmaps for training and the part affinity fields for training into the keypoint detector, to thereby allow the keypoint detector to extract keypoints for training from each of the keypoint heatmaps for training and a process of grouping the extracted keypoints for training by referring to each of the part affinity fields for training, to thereby detect keypoints per each of the objects for training, and (iv) a process of allowing a loss layer to calculate one or more losses by referring to the keypoints per each of the objects for training and their corresponding ground truths, to thereby adjust one or more parameters of the feature extraction network and the keypoint heatmap & part affinity field extractor such that the losses are minimized by backpropagation using the losses.
7. The method of Claim 1, wherein, at the step of (a), the passenger body information-detecting device performs a process of inputting the interior image into the face recognition network, to thereby allow the face recognition network to detect each of the faces of each of the passengers located in the interior image via a face detector, and to output multiple pieces of the passenger feature information on each of the facial images via a facial feature classifier.
8. The method of Claim 1, wherein, at the step of (a), the passenger body information-detecting device performs a process of inputting the interior image into the face recognition network, to thereby allow the face recognition network to (i) apply at least one convolution operation to the interior image and thus to output at least one feature map corresponding to the interior image via at least one convolutional layer, (ii) output one or more proposal boxes, where the passengers are estimated as located, on the feature map, via a region proposal network, (iii) apply pooling operation to one or more regions, corresponding to the proposal boxes, on the feature map and thus to output at least one feature vector via a pooling layer, and (iv) apply fully-connected operation to the feature vector, and thus to output the multiple pieces of the passenger feature information corresponding to each of the faces of each of the passengers corresponding to each of the proposal boxes via a fully connected layer.
9. The method of Claim 1, wherein the multiple pieces of the passenger feature information include each of ages, each of genders and each of races corresponding to each of the passengers.
10. A passenger body information-detecting device for detecting body information on one or more passengers of a vehicle based on humans' status recognition, comprising: at least one memory that stores instructions; and at least one processor configured to execute the instructions to perform or support another device to perform: (I) if at least one interior image of an interior of the vehicle is acquired, (i) a process of inputting the interior image into a face recognition network, to thereby allow the face recognition network to detect each of faces of each of the passengers from the interior image, and thus to output multiple pieces of passenger feature information corresponding to each of the detected faces, and (ii) a process of inputting the interior image into a body recognition network, to thereby allow the body recognition network to detect each of bodies of each of the passengers from the interior image, and thus to output body-part length information of each of the detected bodies, and (II) a process of retrieving specific height mapping information corresponding to specific passenger feature information on a specific passenger from a height mapping table which stores height mapping information representing respective one or more predetermined ratios of one or more segment body portions of each of human groups to each of heights per each of the human groups, a process of acquiring a specific height of the specific passenger from the specific height mapping information by referring to specific body-part length information of the specific passenger, a process of retrieving specific weight mapping information corresponding to the specific passenger feature information from a weight mapping table which stores multiple pieces of weight mapping information representing predetermined correlations between each of the heights and each of weights per each of the human groups, and a process of acquiring a weight of the specific passenger from the specific weight mapping information by referring to the specific height of the specific passenger.
11. The passenger body information-detecting device of Claim 10, wherein, at the process of (I), the processor performs a process of inputting the interior image into the body recognition network, to thereby allow the body recognition network to (i) output one or more feature tensors with one or more channels corresponding to the interior image via a feature extraction network, (ii) generate at least one keypoint heatmap and at least one part affinity field with one or more channels corresponding to each of the feature tensors via a keypoint heatmap & part affinity field extractor, and (iii) extract keypoints from the keypoint heatmap via a keypoint detector, to group the extracted keypoints by referring to the part affinity field, and thus to generate body parts per the passengers, and as a result, allow the body recognition network to output multiple pieces of body-part length information on each of the passengers by referring to the body parts per the passengers.
12. The passenger body information-detecting device of Claim 11, wherein the keypoint heatmap & part affinity field extractor includes one of a fully convolutional network and a 1×1 convolutional layer, and applies a fully-convolution operation or 1×1 convolution operation to the feature tensors, to thereby generate the keypoint heatmap and the part affinity field.
13. The passenger body information-detecting device of Claim 11, wherein the keypoint detector connects, by referring to the part affinity field, pairs respectively having highest mutual connection probabilities of being connected among the extracted keypoints, to thereby group the extracted keypoints.
14. The passenger body information-detecting device of Claim 11, wherein the feature extraction network and the keypoint heatmap & part affinity field extractor have been learned by a learning device performing (i) a process of inputting at least one training image including one or more objects for training into the feature extraction network, to thereby allow the feature extraction network to generate one or more feature tensors for training having one or more channels by applying at least one convolutional operation to the training image, (ii) a process of inputting the feature tensors for training into the keypoint heatmap & part affinity field extractor, to thereby allow the keypoint heatmap & part affinity field extractor to generate one or more keypoint heatmaps for training and one or more part affinity fields for training having one or more channels for each of the feature tensors for training, (iii) a process of inputting the keypoint heatmaps for training and the part affinity fields for training into the keypoint detector, to thereby allow the keypoint detector to extract keypoints for training from each of the keypoint heatmaps for training and a process of grouping the extracted keypoints for training by referring to each of the part affinity fields for training, to thereby detect keypoints per each of the objects for training, and (iv) a process of allowing a loss layer to calculate one or more losses by referring to the keypoints per each of the objects for training and their corresponding ground truths, to thereby adjust one or more parameters of the feature extraction network and the keypoint heatmap & part affinity field extractor such that the losses are minimized by backpropagation using the losses.
15. The passenger body information-detecting device of Claim 10, wherein, at the process of (I), the processor performs a process of inputting the interior image into the face recognition network, to thereby allow the face recognition network to (i) apply at least one convolution operation to the interior image and thus to output at least one feature map corresponding to the interior image via at least one convolutional layer, (ii) output one or more proposal boxes, where the passengers are estimated as located, on the feature map, via a region proposal network, (iii) apply pooling operation to one or more regions, corresponding to the proposal boxes, on the feature map and thus to output at least one feature vector via a pooling layer, and (iv) apply fully-connected operation to the feature vector, and thus to output the multiple pieces of the passenger feature information corresponding to each of the faces of each of the passengers corresponding to each of the proposal boxes via a fully connected layer.
</claims>
</document>
